<!DOCTYPE html>
<html>
<head>
    <title>Verify OTP</title>
</head>
<body>
    <h2>Hello {{ username }}! Enter your 6-digit code</h2>
    <form method="POST" action="/verify">
        <input type="hidden" name="username" value="{{ username }}">
        <label for="token">Authenticator Code:</label>
        <input type="text" name="token" required><br><br>
        <input type="submit" value="Verify">
    </form>
</body>
</html>
@app.route("/verify", methods=["POST"])
def verify():
    username = request.form["username"]
    token = request.form["token"]

    user = users.get(username)
    if not user:
        return "User not found"

    secret = user["secret"]
    totp = pyotp.TOTP(secret)

    if totp.verify(token):
        return render_template("success.html", username=username)
    else:
        return "Invalid token. Please try again."

        <br><br>
<a href="/"><button>Back to Home</button></a>
